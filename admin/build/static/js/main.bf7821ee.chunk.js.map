{"version":3,"sources":["translations/en.js","i18n.js","helpers/request.js","components/Login.js","helpers/json.js","components/Checkpoints.js","components/Users.js","components/Account.js","App.js","index.js"],"names":["module","exports","resources","en","i18n","use","LanguageDetector","initReactI18next","init","fallbackLng","keySeparator","interpolation","escapeValue","detection","order","lookupQuerystring","lookupCookie","lookupLocalStorage","lookupFromPathIndex","lookupFromSubdomainIndex","caches","excludeCacheFor","cookieMinutes","cookieDomain","htmlTag","document","documentElement","checkWhitelist","sendRequest","url","a","method","body","fetch","JSON","stringify","undefined","headers","res","json","Login","onLoginRequest","useState","username","setUsername","password","setPassword","t","useTranslation","onSubmitLogin","event","preventDefault","isLoggedIn","class","onSubmit","for","value","onChange","target","type","id","name","placeholder","href","process","isValidJSON","val","parse","e","Checkpoints","onUpload","style","display","role","files","getElementById","length","fr","FileReader","onload","result","checkpoints","error","alert","reset","readAsText","item","ViewEnum","list","new","Users","currentUser","users","setUsers","view","setView","newUsername","setNewUsername","newCanManage","setNewCanManage","createdUsername","setCreatedUsername","createdPassword","setCreatedPassword","usersList","loadUsers","useEffect","onSubmitNewUser","test","privilege","user","created","handleDelete","userId","window","confirm","onClick","map","canManage","canDelete","checked","Account","currentPassword","setCurrentPassword","newPassword","setNewPassword","onSubmitNewPassword","App","setIsLoggedIn","setCurrentUser","hasSuperPrivilege","fetchCurrentUser","loginSuccessful","className","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.bf7821ee.chunk.js","sourcesContent":["module.exports = {\n  'translation': {\n    'admin': 'Admin',\n    'account_current_password': 'Current password',\n    'account_current_password_incorrect': 'Current password is incorrect.',\n    'account_new_password': 'New password',\n    'account_new_password_invalid': 'New password is not valid.',\n    'account_password_instructions': 'Passwords must be at least 8 characters long.',\n    'account_title': 'Account',\n    'account_update_password_submit': 'Update',\n    'account_update_password_success': 'Your password was updated successfully.',\n    'account_update_password_title': 'Update password',\n    'login_no_account_1': 'Don\\'t have an account? You can request access',\n    'login_no_account_2': 'here',\n    'login_password': 'Password',\n    'login_submit_button': 'Sign in',\n    'login_title': 'Please sign in',\n    'login_username': 'Username',\n    'logout_button': 'Sign out',\n    'menu_account': 'Account',\n    'menu_checkpoints': 'Checkpoints',\n    'menu_users': 'Users',\n    'upload_fail': 'Oops, that upload failed.',\n    'upload_instructions_1': 'A COVID-19 positive patient can open the web app at',\n    'upload_instructions_2': 'The patient should open the \"Status\" tab, and press \"Download Checkpoints\". This will download a file to the patient\\'s phone, which the patient can email to you.',\n    'upload_instructions_3': 'Once you have the file, you may upload it using the button below.',\n    'upload_success': 'The checkpoints were uploaded successfully.',\n    'upload_title': 'Upload Checkpoints',\n    'user_create_can_manage_users': 'Can manage other users',\n    'user_create_credential_delivery': 'Please provide these credentials to the user and instruct them to change their password once they log in.',\n    'user_create_exit': 'Return to all users',\n    'user_create_fail': 'Oops, there was an error creating this user.',\n    'user_create_invalid_username': 'Only letters and numbers are allowed in a username.',\n    'user_create_submit': 'Create',\n    'user_create_success': 'A new user was created with the following credentials',\n    'user_create_title': 'Create a new user',\n    'user_create_username': 'Username',\n    'user_create_password': 'Temporary password',\n    'user_delete_confirm': 'Delete user',\n    'user_delete_fail': 'Oops, something went wrong.',\n    'welcome': 'Welcome'\n  }\n}\n","import i18n from 'i18next'\nimport { initReactI18next } from 'react-i18next'\nimport LanguageDetector from 'i18next-browser-languagedetector'\nimport en from './translations/en'\n\n// the translations\n// (tip move them in a JSON file and import them)\nconst resources = {\n  en\n}\n\ni18n\n  .use(LanguageDetector)\n  .use(initReactI18next) // passes i18n down to react-i18next\n  .init({\n    resources,\n    fallbackLng: 'en',\n    keySeparator: false, // we do not use keys in form messages.welcome\n    interpolation: {\n      escapeValue: false // react already safes from xss\n    },\n    detection: {\n      order: ['querystring', 'cookie', 'localStorage', 'navigator', 'htmlTag', 'path', 'subdomain'],\n\n      // keys or params to lookup language from\n      lookupQuerystring: 'lng',\n      lookupCookie: 'i18next',\n      lookupLocalStorage: 'i18nextLng',\n      lookupFromPathIndex: 0,\n      lookupFromSubdomainIndex: 0,\n\n      // cache user language on\n      caches: ['localStorage', 'cookie'],\n      excludeCacheFor: ['cimode'], // languages to not persist (cookie, localStorage)\n\n      // optional expire and domain for set cookie\n      cookieMinutes: 10,\n      cookieDomain: 'myDomain',\n\n      // optional htmlTag with lang attribute, the default is:\n      htmlTag: document.documentElement,\n\n      // only detect languages that are in the whitelist\n      checkWhitelist: true\n    }\n  })\n\nexport default i18n\n","/* globals fetch */\n\nexport const sendRequest = async (url, method = 'GET', body) => {\n  const res = await fetch(url, {\n    method,\n    body: body ? JSON.stringify(body) : undefined,\n    headers: { 'Content-Type': 'application/json' }\n  })\n  return res.json()\n}\n","import React, { useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { sendRequest } from '../helpers/request'\n\nexport function Login ({ onLoginRequest }) {\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  const { t } = useTranslation()\n\n  const onSubmitLogin = async (event) => {\n    event.preventDefault()\n    const res = await sendRequest('/admin/login', 'POST', { username, password })\n    onLoginRequest(res && res.isLoggedIn)\n  }\n\n  const onchangeUsername = (event) => {\n    setUsername(event.target.value)\n  }\n\n  const onchangePassword = (event) => {\n    setPassword(event.target.value)\n  }\n\n  return (\n    <form class='form-signin' onSubmit={onSubmitLogin}>\n      <h1 class='h3 mb-3 font-weight-normal'>{t('login_title')}</h1>\n      <label for='username' class='sr-only'>{t('login_username')}:</label><br />\n      <input value={username} onChange={onchangeUsername} type='text' id='username' name='username' placeholder={t('login_username')} class='form-control' /><br />\n      <label for='password' class='sr-only'>{t('login_password')}:</label><br />\n      <input value={password} onChange={onchangePassword} type='password' id='password' name='password' placeholder={t('login_password')} class='form-control' /><br /><br />\n      <button class='btn btn-lg btn-warning btn-block' type='submit'>{t('login_submit_button')}</button>\n      {process.env.REACT_APP_REGISTRATION_URL && (\n        <p class='mt-5 mb-3 text-muted'>\n          {t('login_no_account_1')} <a href={process.env.REACT_APP_REGISTRATION_URL} target='_blank' class='text-warning'>{t('login_no_account_2')}</a>.\n        </p>\n      )}\n      <p class='mt-5 mb-3 text-muted'>{process.env.REACT_APP_NAME} {t('admin')}</p>\n    </form>\n  )\n}\n","export const isValidJSON = val => {\n  try {\n    JSON.parse(val)\n  } catch (e) {\n    return false\n  }\n  return true\n}\n","/* globals alert, FileReader */\nimport React from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { sendRequest } from '../helpers/request'\nimport { isValidJSON } from '../helpers/json'\n\nexport function Checkpoints ({ onUpload }) {\n  const { t } = useTranslation()\n  const webAppUrl = process.env.REACT_APP_WEB_APP_URL\n\n  const handleUpload = () => {\n    const files = document.getElementById('checkpoint-upload').files\n    if (files.length <= 0) {\n      return false\n    }\n    const fr = new FileReader()\n    fr.onload = async (e) => {\n      if (e && e.target.result && isValidJSON(e.target.result)) {\n        const result = JSON.parse(e.target.result)\n        const res = await sendRequest(\n          '/admin/api/checkpoints',\n          'POST',\n          { checkpoints: result }\n        )\n        if (res && !res.error) {\n          alert(t('upload_success'))\n        } else {\n          alert(t('upload_fail'))\n        }\n        document.getElementById('checkpoint-upload-form').reset()\n      } else {\n        alert(t('upload_fail'))\n      }\n    }\n    fr.readAsText(files.item(0))\n  }\n\n  return (\n    <div>\n      <div class='d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom'>\n        <h1 class='h2'>{t('upload_title')}</h1>\n      </div>\n      <form id='checkpoint-upload-form'>\n        <p>{t('upload_instructions_1')} {webAppUrl}. {t('upload_instructions_2')}</p>\n        <p>{t('upload_instructions_3')}</p>\n        <div class='alert alert-success' style={{ display: 'none' }} id='upload-success' role='alert'>\n          {t('upload_success')}\n        </div>\n        <input class='btn btn-large btn-warning' type='file' id='checkpoint-upload' onChange={handleUpload} />\n      </form>\n    </div>\n  )\n}\n","/* globals alert */\nimport React, { useEffect, useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { sendRequest } from '../helpers/request'\n\nconst superPrivilegeLevel = 1\nconst defaultPrivilegeLevel = 2\n\nconst ViewEnum = {\n  list: 1,\n  new: 2\n}\n\nexport function Users ({ currentUser }) {\n  const [users, setUsers] = useState(undefined)\n  const [view, setView] = useState(ViewEnum.list)\n  const [newUsername, setNewUsername] = useState('')\n  const [newCanManage, setNewCanManage] = useState(false)\n  const [createdUsername, setCreatedUsername] = useState('')\n  const [createdPassword, setCreatedPassword] = useState('')\n  const { t } = useTranslation()\n  const usersList = users || []\n\n  const loadUsers = async () => {\n    const res = await sendRequest('/admin/api/users')\n    if (res && res.users) {\n      setUsers(res.users)\n    }\n  }\n\n  useEffect(() => {\n    if (typeof users === 'undefined') {\n      loadUsers()\n    }\n  })\n\n  const onSubmitNewUser = async (event) => {\n    event.preventDefault()\n    const usernameRegex = /((^[a-z]+)|(^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+[0-9a-z]+$/i\n    if (usernameRegex.test(newUsername)) {\n      const privilege = newCanManage ? superPrivilegeLevel : defaultPrivilegeLevel\n      const res = await sendRequest(\n        '/admin/api/users',\n        'POST',\n        { username: newUsername, privilege }\n      )\n      if (res.error) {\n        alert(t('user_create_fail'))\n      } else {\n        setCreatedUsername(res.user.username)\n        setCreatedPassword(res.user.password)\n        setView(ViewEnum.created)\n        loadUsers()\n      }\n      setNewUsername('')\n      setNewCanManage(false)\n    } else {\n      alert(t('user_create_invalid_username'))\n    }\n  }\n\n  const onchangeUsername = (event) => {\n    setNewUsername(event.target.value)\n  }\n\n  const onchangeNewCanManage = () => {\n    setNewCanManage(!newCanManage)\n  }\n\n  const handleDelete = async (userId, username) => {\n    if (window.confirm(`${t('user_delete_confirm')}: ${username}?`)) {\n      const res = await sendRequest(`/admin/api/users/${userId}`, 'DELETE')\n      if (res && !res.error) {\n        loadUsers()\n      } else {\n        alert(t('user_delete_fail'))\n      }\n    }\n  }\n\n  return (\n    <div>\n      <div class='d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom'>\n        <h1 class='h2'>Users</h1>\n      </div>\n      {view === ViewEnum.list && (\n        <div>\n          <a class='btn btn-dark text-light mb-2' onClick={() => setView(ViewEnum.new)}>\n            New user\n          </a>\n          <ul class='list-group'>\n            {usersList.map(user => {\n              const canManage = user.privilege === superPrivilegeLevel\n              const canDelete = user.id !== currentUser.id\n              return (\n                <li class='list-group-item user-list'>\n                  <strong>{user.username}</strong>\n                  {canManage && (\n                    <span> (can manage users)</span>\n                  )}\n                  {canDelete && (\n                    <a onClick={() => handleDelete(user.id, user.username)} class='btn btn-danger text-light user-delete'>\n                      Delete\n                    </a>\n                  )}\n                </li>\n              )\n            })}\n          </ul>\n        </div>\n      )}\n      {view === ViewEnum.new && (\n        <form class='form-signin' onSubmit={onSubmitNewUser}>\n          <h2 class='h3 mb-3 font-weight-normal'>{t('user_create_title')}</h2>\n          <label for='username' class='sr-only'>{t('user_create_username')}:</label>\n          <input value={newUsername} onChange={onchangeUsername} type='text' id='username' name='username' placeholder={t('user_create_username')} class='form-control' />\n          <div class='form-check'>\n            <input checked={newCanManage} onChange={onchangeNewCanManage} class='form-check-input' type='checkbox' id='can-manage' />\n            <label class='form-check-label' for='can-manage'>\n              {t('user_create_can_manage_users')}\n            </label>\n          </div>\n          <button class='btn btn-lg btn-warning btn-block mt-3' type='submit'>{t('user_create_submit')}</button>\n        </form>\n      )}\n      {view === ViewEnum.created && (\n        <div>\n          <h2 class='h3 mb-3 font-weight-normal'>{t('user_create_success')}:</h2>\n          <p>{t('user_create_username')}: <strong>{createdUsername}</strong></p>\n          <p>{t('user_create_password')}: <strong>{createdPassword}</strong></p>\n          <p>{t('user_create_credential_delivery')}</p>\n          <a class='btn btn-dark text-light mt-2' onClick={() => setView(ViewEnum.list)}>\n            {t('user_create_exit')}\n          </a>\n        </div>\n      )}\n    </div>\n  )\n}\n","/* globals alert */\nimport React, { useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { sendRequest } from '../helpers/request'\n\nexport function Account () {\n  const [currentPassword, setCurrentPassword] = useState('')\n  const [newPassword, setNewPassword] = useState('')\n  const { t } = useTranslation()\n\n  const onSubmitNewPassword = async (event) => {\n    event.preventDefault()\n    const passwordRegex = /^[\\w!@#$%^&*]{8,}$/\n    if (passwordRegex.test(newPassword)) {\n      const res = await sendRequest(\n        '/admin/api/account',\n        'PUT',\n        { currentPassword, newPassword }\n      )\n      if (res.error) {\n        alert(t('account_current_password_incorrect'))\n      } else {\n        alert(t('account_update_password_success'))\n        setCurrentPassword('')\n        setNewPassword('')\n      }\n    } else {\n      alert(t('account_new_password_invalid'))\n    }\n  }\n\n  const onchangeCurrentPassword = (event) => {\n    setCurrentPassword(event.target.value)\n  }\n\n  const onchangeNewPassword = (event) => {\n    setNewPassword(event.target.value)\n  }\n\n  return (\n    <div>\n      <div class='d-flex justify-content-between flex-wrap flex-md-nowrap align-items-left pt-3 pb-2 mb-3 border-bottom'>\n        <h1 class='h2'>{t('account_title')}</h1>\n      </div>\n      <form class='form-signin' onSubmit={onSubmitNewPassword}>\n        <h2 class='h3 mb-3 font-weight-normal'>{t('account_update_password_title')}</h2>\n        <p>{t('account_password_instructions')}</p>\n        <label for='current-password' class='sr-only'>{t('account_current_password')}:</label>\n        <input value={currentPassword} onChange={onchangeCurrentPassword} type='password' id='username' name='current-password' placeholder={t('account_current_password')} class='form-control' />\n        <label for='new-password' class='sr-only'>{t('account_new_password')}:</label>\n        <input value={newPassword} onChange={onchangeNewPassword} type='password' id='username' name='new-password' placeholder={t('account_new_password')} class='form-control' />\n        <button class='btn btn-lg btn-warning btn-block mt-3' type='submit'>{t('account_update_password_submit')}</button>\n      </form>\n    </div>\n  )\n}\n","/* globals alert */\nimport React, { useEffect, useState } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport './App.css'\nimport { sendRequest } from './helpers/request'\nimport { Login } from './components/Login'\nimport { Checkpoints } from './components/Checkpoints'\nimport { Users } from './components/Users'\nimport { Account } from './components/Account'\n\nconst ViewEnum = {\n  checkpoints: 1,\n  users: 2,\n  account: 3\n}\n\nconst superPrivilegeLevel = 1\n\nfunction App () {\n  const [isLoggedIn, setIsLoggedIn] = useState(undefined)\n  const [currentUser, setCurrentUser] = useState({})\n  const [view, setView] = useState(ViewEnum.checkpoints)\n  const { t } = useTranslation()\n  const hasSuperPrivilege = (currentUser && currentUser.privilege === superPrivilegeLevel)\n\n  const fetchCurrentUser = async () => {\n    const res = await sendRequest('/admin/api/status')\n    if (res) {\n      setIsLoggedIn(res.isLoggedIn)\n      setCurrentUser(res.user)\n    }\n  }\n\n  useEffect(() => {\n    if (typeof isLoggedIn === 'undefined') {\n      fetchCurrentUser()\n    }\n  })\n\n  const onSubmitLogin = async (loginSuccessful) => {\n    if (loginSuccessful) {\n      fetchCurrentUser()\n    } else {\n      alert('Login failed')\n    }\n  }\n\n  if (isLoggedIn) {\n    return (\n      <div className='App'>\n        <nav class='navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow'>\n          <a class='navbar-brand col-sm-3 col-md-2 mr-0' href='/admin'>{process.env.REACT_APP_NAME} {t('admin')}</a>\n          <ul class='navbar-nav px-3'>\n            <li class='nav-item text-nowrap'>\n              <a class='nav-link' href='/admin/logout'>{t('logout_button')}</a>\n            </li>\n          </ul>\n        </nav>\n\n        <div class='container-fluid'>\n          <div class='row'>\n            <nav class='col-md-2 d-none d-md-block bg-light sidebar'>\n              <div class='sidebar-sticky'>\n                <ul class='nav flex-column'>\n                  <li class='nav-item'>\n                    <a class='nav-link' onClick={() => setView(ViewEnum.checkpoints)}>\n                      {t('menu_checkpoints')}\n                    </a>\n                  </li>\n                  {hasSuperPrivilege && (\n                    <li class='nav-item'>\n                      <a class='nav-link' onClick={() => setView(ViewEnum.users)}>\n                        {t('menu_users')}\n                      </a>\n                    </li>\n                  )}\n                  <li class='nav-item'>\n                    <a class='nav-link' onClick={() => setView(ViewEnum.account)}>\n                      {t('menu_account')}\n                    </a>\n                  </li>\n                </ul>\n              </div>\n            </nav>\n\n            <main role='main' class='col-md-9 ml-sm-auto col-lg-10 px-4'>\n              <p class='mt-3'>{t('welcome')}, {currentUser.username}.</p>\n              {view === ViewEnum.checkpoints && (\n                <Checkpoints />\n              )}\n              {hasSuperPrivilege && view === ViewEnum.users && (\n                <Users currentUser={currentUser} />\n              )}\n              {view === ViewEnum.account && (\n                <Account />\n              )}\n            </main>\n          </div>\n        </div>\n      </div>\n    )\n  } else {\n    return (\n      <div class='login-container bg-dark text-center text-light'>\n        <Login onLoginRequest={onSubmitLogin} />\n      </div>\n    )\n  }\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport './bootstrap.min.css'\nimport './i18n'\nimport App from './App'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}